<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Folder Viewer</title>
    <style>
        .folder {
            margin: 10px 0;
        }
        .folder-title {
            cursor: pointer;
            font-weight: bold;
            background-color: #f0f0f0;
            padding: 5px;
            border-radius: 3px;
        }
        .file-list {
            display: none;
            margin-left: 20px;
        }
        .file-list.active {
            display: block;
        }
        .markdown-content {
            margin-top: 10px;
        }
        textarea {
            width: 100%;
            height: 200px;
            font-family: monospace;
        }
        #request-changes {
            margin-top: 10px;
            padding: 5px 10px;
            background-color: #ccc;
            border: none;
            cursor: not-allowed;
        }
        #request-changes.active {
            background-color: #28a745;
            color: white;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="folder">
        <div class="folder-title">Folder 1</div>
        <div class="file-list">
            <div class="file" data-path="folder1/file1.md">file1.md</div>
            <div class="file" data-path="folder1/file2.md">file2.md</div>
        </div>
    </div>
    <div class="folder">
        <div class="folder-title">Folder 2</div>
        <div class="file-list">
            <div class="file" data-path="folder2/file3.md">file3.md</div>
        </div>
    </div>
    <div class="markdown-content" style="display: none;">
        <h3>Editing: <span id="file-name"></span></h3>
        <textarea id="markdown-editor"></textarea>
        <button id="request-changes" disabled>Request Changes</button>
    </div>

    <script>
        // Toggle file list visibility when folder title is clicked
        document.querySelectorAll('.folder-title').forEach(title => {
            title.addEventListener('click', () => {
                const fileList = title.nextElementSibling;
                fileList.classList.toggle('active');
            });
        });

        // Sample Markdown content (replace with actual content in a real scenario)
        const markdownFiles = {
            'folder1/file1.md': '# Sample File 1\nThis is a test.',
            'folder1/file2.md': '# Sample File 2\nAnother test.',
            'folder2/file3.md': '# Sample File 3\nYet another test.'
        };

        // Handle file clicks to show editable content
        document.querySelectorAll('.file').forEach(file => {
            file.addEventListener('click', () => {
                const path = file.getAttribute('data-path');
                const content = markdownFiles[path] || 'Content not found.';
                const editor = document.getElementById('markdown-editor');
                const fileName = document.getElementById('file-name');
                const requestButton = document.getElementById('request-changes');
                const markdownContent = document.querySelector('.markdown-content');

                // Show editor and set initial content
                markdownContent.style.display = 'block';
                fileName.textContent = path;
                editor.value = content;
                requestButton.disabled = true;
                requestButton.classList.remove('active');

                // Track original content for comparison
                const originalContent = content;

                // Enable "Request Changes" button when content changes
                editor.addEventListener('input', () => {
                    if (editor.value !== originalContent) {
                        requestButton.disabled = false;
                        requestButton.classList.add('active');
                    } else {
                        requestButton.disabled = true;
                        requestButton.classList.remove('active');
                    }
                });

                // Handle "Request Changes" click
                requestButton.onclick = () => {
                    if (!requestButton.disabled) {
                        const githubEditUrl = `https://github.com/KarthikeyaTirlangi/TrailOCR/edit/main/${path}`;
                        // In a real scenario, you could encode the updated content and suggest a PR,
                        // but here we simply redirect to GitHub's edit page.
                        window.open(githubEditUrl, '_blank');
                    }
                };
            });
        });
    </script>
</body>
</html>
